# Royale Arena 后端任务清单

## 1. 项目初始化
- [x] 初始化Rust项目
- [x] 集成Web框架（Actix-web）
- [ ] 集成WebSocket库
- [x] 添加MySQL驱动依赖项（尚未实际集成使用）
- [x] 集成serde用于JSON序列化
- [x] 集成tracing用于日志记录

## 2. 核心功能模块开发
### REST API服务器
- [x] 实现基础服务器框架并解决Docker访问问题
- [ ] 实现用户认证（管理员登录验证）
- [ ] 实现游戏状态及设置查询
- [ ] 实现玩家信息获取
- [ ] 实现游戏规则获取

### WebSocket服务器
- [ ] 实现玩家行动指令接收
- [ ] 实现实时游戏状态推送
- [ ] 实现导演操作指令处理
- [ ] 实现行动结果反馈

### 游戏逻辑引擎
- [ ] 实现行动时间窗口管理
- [ ] 实现玩家状态更新（生命值、体力值、位置等）
- [ ] 实现道具系统处理（搜索、使用、合成等）
- [ ] 实现安全区缩圈逻辑
- [ ] 实现投票系统处理

### 数据管理模块
- [ ] 实现静态数据访问（通过MySQL存储玩家信息等）
- [ ] 实现动态数据管理（游戏运行时所有数据在内存中处理）
- [ ] 实现数据持久化（行动结束后将游戏状态保存到本地文件）

## 3. 接口实现
### REST API端点
- [ ] 实现`POST /api/login` - 用户登录验证
- [ ] 实现`GET /api/game/{id}` - 获取游戏基本信息
- [ ] 实现`GET /api/player/{id}` - 获取玩家详细信息
- [ ] 实现`GET /api/rules` - 获取游戏规则

### WebSocket通信
- [ ] 实现连接时的身份验证
- [ ] 实现玩家行动指令处理（移动、搜索、攻击、使用道具）
- [ ] 实现服务器实时状态推送
- [ ] 实现导演控制指令处理（开始行动、结束行动、缩圈、空投等）

## 4. 系统约束与性能
- [ ] 确保不使用游戏引擎或第三方实时通信服务
- [ ] 确保不使用ORM框架，直接操作MySQL数据库
- [ ] 确保WebSocket仅处理实时操作指令
- [ ] 确保REST API仅处理认证和状态查询
- [ ] 确保游戏过程中不访问数据库，所有数据都在内存中
- [ ] 确保不复用旧版Python系统的任何代码
- [ ] 实现高并发处理能力，支持最多100名玩家同时在线
- [ ] 实现低延迟响应，确保实时操作的流畅性
- [ ] 实现内存高效管理，避免内存泄漏
- [ ] 确保系统稳定性，能够长时间运行

## 5. 安全与测试
- [ ] 实现密码明文存储（仅为项目特定设计）
- [ ] 实现通过URI中的密码参数直接访问导演控制台和玩家界面
- [ ] 实现WebSocket连接的身份验证机制
- [ ] 实现防止恶意操作的验证机制
- [ ] 编写单元测试和集成测试
- [ ] 进行性能测试和压力测试