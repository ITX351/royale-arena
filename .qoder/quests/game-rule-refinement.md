# æ¸¸æˆè§„åˆ™ä¼˜åŒ–è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

æœ¬è®¾è®¡æ–‡æ¡£æ—¨åœ¨ä¼˜åŒ–Royale Arenaæ¸¸æˆçš„è§„åˆ™å®ç°é€»è¾‘ï¼Œä½¿å‰ç«¯å’Œåç«¯çš„æ¸¸æˆè¿è¡Œé€»è¾‘ä¸å…·ä½“è§„åˆ™è®¾å®šä¿æŒä¸€è‡´ã€‚åŸºäºå½“å‰çš„è§„åˆ™é…ç½®æ–‡ä»¶ï¼Œå°†ä¸ºç³»ç»Ÿå„ä¸ªå±‚é¢å®ç°å®Œæ•´çš„è§„åˆ™æ”¯æŒï¼Œç¡®ä¿æ¯ä¸€æ¡è§„åˆ™è®¾å®šéƒ½æœ‰å®é™…æ•ˆæœã€‚

**é‡è¦è¯´æ˜ï¼š** æ‰€æœ‰ç³»ç»Ÿå›å¤å’Œæ–‡æ¡£å†…å®¹å‡ä½¿ç”¨ç®€ä½“ä¸­æ–‡ã€‚

## è§„åˆ™åº”ç”¨å±‚æ¬¡åˆ†æ

### è§„åˆ™è®¾ç½®åº”ç”¨åˆ†å¸ƒ

è§„åˆ™è®¾ç½®æŒ‰ç…§åº”ç”¨ä½ç½®å¯åˆ†ä¸ºä»¥ä¸‹å››ä¸ªå±‚æ¬¡ï¼š

#### ç©å®¶å‰ç«¯å±‚
è´Ÿè´£å±•ç¤ºå’Œçº¦æŸç©å®¶çš„æ“ä½œç•Œé¢ï¼ŒåŒ…æ‹¬ï¼š
- ç©å®¶å±æ€§æ˜¾ç¤ºï¼ˆç”Ÿå‘½å€¼ã€ä½“åŠ›å€¼ä¸Šé™ï¼‰
- è¡ŒåŠ¨æŒ‰é’®çš„å¯ç”¨æ€§æ§åˆ¶
- ç‰©å“èƒŒåŒ…å®¹é‡é™åˆ¶æ˜¾ç¤º
- æœç´¢å†·å´æ—¶é—´å€’è®¡æ—¶
- è£…å¤‡æ•°é‡é™åˆ¶æç¤º

#### ç©å®¶åå°å±‚
è´Ÿè´£éªŒè¯å’Œå¤„ç†ç©å®¶æ“ä½œçš„æœåŠ¡ç«¯é€»è¾‘ï¼ŒåŒ…æ‹¬ï¼š
- è¡ŒåŠ¨ä½“åŠ›æ¶ˆè€—éªŒè¯
- æœç´¢å†·å´æ—¶é—´æ£€æŸ¥
- ç‰©å“ä½¿ç”¨æ•ˆæœè®¡ç®—
- è£…å¤‡é™åˆ¶éªŒè¯
- æ­»äº¡çŠ¶æ€æ£€æŸ¥

#### å¯¼æ¼”å‰ç«¯å±‚
è´Ÿè´£å¯¼æ¼”ç®¡ç†ç•Œé¢çš„æ˜¾ç¤ºå’Œæ§åˆ¶ï¼ŒåŒ…æ‹¬ï¼š
- æ¸¸æˆè§„åˆ™é…ç½®ç¼–è¾‘ç•Œé¢
- ç©å®¶çŠ¶æ€å®æ—¶ç›‘æ§
- ç‰©å“ç®¡ç†å’Œç©ºæŠ•æ§åˆ¶
- åœ°å›¾çŠ¶æ€è°ƒæ•´ç•Œé¢

#### å¯¼æ¼”åå°å±‚
è´Ÿè´£å¤„ç†å¯¼æ¼”æ“ä½œå’Œæ¸¸æˆçŠ¶æ€ç®¡ç†ï¼ŒåŒ…æ‹¬ï¼š
- è§„åˆ™é…ç½®è§£æå’Œåº”ç”¨
- ç©å®¶çŠ¶æ€å¼ºåˆ¶ä¿®æ”¹
- ç‰©å“ç”Ÿæˆå’Œåˆ†é…
- æ¸¸æˆç¯å¢ƒæ§åˆ¶ï¼ˆå¤©æ°”ã€ç¼©åœˆï¼‰

## æ“ä½œå®ç°é€»è¾‘è®¾è®¡

### ç©å®¶æ“ä½œé€»è¾‘

#### å‡ºç”Ÿæ“ä½œ
**å®ç°ä½ç½®ï¼š** ç©å®¶åå°å±‚
**è§„åˆ™ä¾èµ–ï¼š** åœ°å›¾é…ç½®ä¸­çš„æœ‰æ•ˆåœ°ç‚¹åˆ—è¡¨
**é€»è¾‘æµç¨‹ï¼š**
1. éªŒè¯ç©å®¶æ˜¯å¦å·²å‡ºç”Ÿï¼ˆå…¬ç”¨å‡½æ•°æ£€æŸ¥ï¼‰
2. éªŒè¯ç›®æ ‡åœ°ç‚¹æ˜¯å¦å­˜åœ¨ä¸”æœªè¢«æ‘§æ¯
3. æ›´æ–°ç©å®¶ä½ç½®çŠ¶æ€
4. å°†ç©å®¶æ·»åŠ åˆ°åœ°ç‚¹çš„ç©å®¶åˆ—è¡¨

#### ç§»åŠ¨æ“ä½œ
**å®ç°ä½ç½®ï¼š** ç©å®¶åå°å±‚
**è§„åˆ™ä¾èµ–ï¼š** è¡ŒåŠ¨æ¶ˆè€—é…ç½®ã€åœ°å›¾çŠ¶æ€
**é€»è¾‘æµç¨‹ï¼š**
1. æ£€æŸ¥ç©å®¶åŸºç¡€çŠ¶æ€ï¼ˆå­˜æ´»ã€å·²å‡ºç”Ÿï¼‰
2. éªŒè¯ä½“åŠ›æ˜¯å¦å……è¶³ï¼ˆæ¶ˆè€—å€¼æ¥è‡ªé…ç½®ï¼‰
3. éªŒè¯ç›®æ ‡åœ°ç‚¹æœ‰æ•ˆæ€§
4. æ‰£é™¤ä½“åŠ›å¹¶æ›´æ–°ä½ç½®

#### æœç´¢æ“ä½œ
**å®ç°ä½ç½®ï¼š** ç©å®¶åå°å±‚
**è§„åˆ™ä¾èµ–ï¼š** æœç´¢å†·å´æ—¶é—´ã€ä½“åŠ›æ¶ˆè€—ã€å¤©æ°”å½±å“
**é€»è¾‘æµç¨‹ï¼š**
1. æ£€æŸ¥ç©å®¶åŸºç¡€çŠ¶æ€
2. éªŒè¯æœç´¢å†·å´æ—¶é—´
3. æ±‡æ€»å½“å‰åœ°ç‚¹çš„æ‰€æœ‰ç©å®¶å’Œç‰©å“
4. ç­‰æ¦‚ç‡éšæœºé€‰æ‹©ä¸€ä¸ªç›®æ ‡è¿”å›
5. æ ¹æ®å¤©æ°”å€¼ç¡®å®šå¯è§æ€§

#### æ”»å‡»æ“ä½œ
**å®ç°ä½ç½®ï¼š** ç©å®¶åå°å±‚
**è§„åˆ™ä¾èµ–ï¼š** æ­¦å™¨ä¼¤å®³é…ç½®ã€é˜²å…·é˜²å¾¡ã€æ”»å‡»æ¶ˆè€—
**é€»è¾‘æµç¨‹ï¼š**
1. æ£€æŸ¥ç©å®¶åŸºç¡€çŠ¶æ€å’Œæ­¦å™¨è£…å¤‡
2. éªŒè¯æ”»å‡»ç›®æ ‡çš„æœ‰æ•ˆæ€§
3. è®¡ç®—ä¼¤å®³å€¼ï¼ˆæ­¦å™¨ä¼¤å®³ - ç›®æ ‡é˜²å…·é˜²å¾¡ï¼‰
4. åº”ç”¨æ”»å‡»æ•ˆæœï¼ˆæ™®é€šä¼¤å®³ã€èŒƒå›´ä¼¤å®³ã€æŒç»­ä¼¤å®³ï¼‰
5. å¤„ç†æ­»äº¡åç‰©å“åˆ†é…

#### è£…å¤‡æ“ä½œ
**å®ç°ä½ç½®ï¼š** ç©å®¶åå°å±‚
**è§„åˆ™ä¾èµ–ï¼š** è£…å¤‡æ•°é‡é™åˆ¶ã€ç‰©å“åˆ†ç±»
**é€»è¾‘æµç¨‹ï¼š**
1. æ£€æŸ¥ç©å®¶åŸºç¡€çŠ¶æ€
2. éªŒè¯è£…å¤‡ç±»å‹å’Œæ•°é‡é™åˆ¶
3. å¤„ç†è£…å¤‡æ›¿æ¢é€»è¾‘
4. æ›´æ–°ç©å®¶è£…å¤‡çŠ¶æ€

#### ä½¿ç”¨ç‰©å“æ“ä½œ
**å®ç°ä½ç½®ï¼š** ç©å®¶åå°å±‚
**è§„åˆ™ä¾èµ–ï¼š** ç‰©å“æ•ˆæœé…ç½®ã€æ¶ˆè€—å“è®¾å®š
**é€»è¾‘æµç¨‹ï¼š**
1. æ£€æŸ¥ç©å®¶åŸºç¡€çŠ¶æ€
2. éªŒè¯ç‰©å“ç±»å‹å’Œæ•ˆæœ
3. åº”ç”¨ç‰©å“æ•ˆæœï¼ˆæ²»ç–—ã€ä½“åŠ›æ¢å¤ã€è§£é™¤çŠ¶æ€ï¼‰
4. å¤„ç†ç‰©å“æ¶ˆè€—

### å¯¼æ¼”æ“ä½œé€»è¾‘

#### ç©å®¶çŠ¶æ€è°ƒæ•´
**å®ç°ä½ç½®ï¼š** å¯¼æ¼”åå°å±‚
**è§„åˆ™ä¾èµ–ï¼š** ç©å®¶å±æ€§ä¸Šé™é…ç½®
**é€»è¾‘æµç¨‹ï¼š**
1. éªŒè¯ç›®æ ‡ç©å®¶å­˜åœ¨æ€§
2. åº”ç”¨æ•°å€¼è°ƒæ•´ï¼ˆè€ƒè™‘ä¸Šé™çº¦æŸï¼‰
3. å¤„ç†çŠ¶æ€å˜åŒ–ï¼ˆæ­»äº¡/å¤æ´»ï¼‰
4. å¹¿æ’­çŠ¶æ€æ›´æ–°

#### ç‰©å“ç®¡ç†
**å®ç°ä½ç½®ï¼š** å¯¼æ¼”åå°å±‚
**è§„åˆ™ä¾èµ–ï¼š** ç‰©å“é…ç½®ã€ç¨€æœ‰åº¦è®¾å®š
**é€»è¾‘æµç¨‹ï¼š**
1. éªŒè¯ç‰©å“ç±»å‹å’Œå±æ€§
2. æ‰§è¡Œç‰©å“ç»™äºˆæˆ–ç§»é™¤
3. æ›´æ–°ç›®æ ‡èƒŒåŒ…æˆ–åœ°ç‚¹ç‰©å“åˆ—è¡¨

#### ç¯å¢ƒæ§åˆ¶
**å®ç°ä½ç½®ï¼š** å¯¼æ¼”åå°å±‚
**è§„åˆ™ä¾èµ–ï¼š** åœ°å›¾é…ç½®ã€å¤©æ°”å½±å“è®¾å®š
**é€»è¾‘æµç¨‹ï¼š**
1. æ›´æ–°ç¯å¢ƒå‚æ•°ï¼ˆå¤©æ°”ã€æ—¶é—´ï¼‰
2. å¤„ç†åœ°ç‚¹çŠ¶æ€å˜æ›´
3. åº”ç”¨ç¯å¢ƒå½±å“æ•ˆæœ

## åç«¯è§„åˆ™ç»“æ„ä½“è®¾è®¡

### æ ¸å¿ƒç»“æ„ä½“å®šä¹‰

åŸºäºå‰ç«¯çš„`gameRuleParser.ts`è®¾è®¡æ€è·¯ï¼Œåç«¯éœ€è¦å®ç°å¯¹åº”çš„Rustç»“æ„ä½“æ¥è§£æå’Œåº”ç”¨æ¸¸æˆè§„åˆ™é…ç½®ã€‚

#### åœ°å›¾é…ç½®ç»“æ„ä½“
```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct MapConfig {
    pub places: Vec<String>,
    pub safe_places: Vec<String>,
}
```

#### ç©å®¶é…ç½®ç»“æ„ä½“
```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct PlayerConfig {
    pub max_life: i32,
    pub max_strength: i32,
    pub daily_strength_recovery: i32,
    pub search_cooldown: i64,
    pub max_equipped_weapons: usize,
    pub max_equipped_armors: usize,
    pub max_backpack_items: usize,
}
```

#### è¡ŒåŠ¨æ¶ˆè€—é…ç½®ç»“æ„ä½“
```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct ActionCosts {
    pub move_cost: i32,
    pub search: i32,
    pub pick: i32,
    pub attack: i32,
    pub equip: i32,
    pub use_item: i32,
    pub throw: i32,
    pub deliver: i32,
}
```

#### ç‰©å“ç³»ç»Ÿé…ç½®ç»“æ„ä½“
```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct ItemsConfig {
    pub rarity_levels: Vec<RarityLevel>,
    pub weapons: Vec<WeaponConfig>,
    pub armors: Vec<ArmorConfig>,
    pub other_items: Vec<OtherItemConfig>,
    pub consumables: Vec<ConsumableConfig>,
    pub upgraders: Vec<UpgraderConfig>,
    pub upgrade_recipes: HashMap<String, Vec<UpgradeRecipe>>,
}

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct WeaponConfig {
    pub internal_name: String,
    pub display_names: Vec<String>,
    pub rarity: String,
    pub properties: WeaponProperties,
}

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct WeaponProperties {
    pub damage: i32,
    pub uses: Option<i32>,
    pub votes: i32,
    pub aoe_damage: Option<i32>,
    pub bleed_damage: Option<i32>,
}
```

### è§„åˆ™è§£æå™¨å®ç°

```rust
#[derive(Debug, Clone)]
pub struct GameRuleEngine {
    pub map_config: MapConfig,
    pub player_config: PlayerConfig,
    pub action_costs: ActionCosts,
    pub rest_mode: RestModeConfig,
    pub items_config: ItemsConfig,
    pub teammate_behavior: TeammateBehaior,
    pub death_item_disposition: DeathItemDisposition,
}

impl GameRuleEngine {
    pub fn from_json(rules_json: &str) -> Result<Self, String> {
        // è§£æJSONé…ç½®æ–‡ä»¶å¹¶æ„å»ºè§„åˆ™å¼•æ“
    }
    
    pub fn validate_action(&self, player: &Player, action: &PlayerAction) -> Result<(), String> {
        // éªŒè¯ç©å®¶æ“ä½œæ˜¯å¦ç¬¦åˆè§„åˆ™
    }
    
    pub fn calculate_damage(&self, attacker: &Player, target: &Player, weapon: &Item) -> DamageResult {
        // æ ¹æ®æ­¦å™¨å’Œé˜²å…·é…ç½®è®¡ç®—ä¼¤å®³
    }
    
    pub fn apply_item_effect(&self, player: &mut Player, item: &Item) -> Vec<GameEffect> {
        // åº”ç”¨ç‰©å“ä½¿ç”¨æ•ˆæœ
    }
}
```

## åŠŸèƒ½ç»†åŒ–å®ç°

### å‡ºç”ŸçŠ¶æ€æ£€æŸ¥å…¬ç”¨å‡½æ•°

åœ¨`GameState`ä¸­æ·»åŠ å‡ºç”ŸçŠ¶æ€æ£€æŸ¥å‡½æ•°ï¼š

```rust
impl GameState {
    /// æ£€æŸ¥ç©å®¶æ˜¯å¦å·²å‡ºç”Ÿ
    fn check_player_born_status(&self, player_id: &str) -> Result<(), ActionResult> {
        let player = self.players.get(player_id)
            .ok_or_else(|| ActionResult::new_info_message(
                serde_json::json!({}),
                vec![player_id.to_string()],
                "ç©å®¶æœªæ‰¾åˆ°".to_string(),
                false
            ))?;
        
        if player.location.is_empty() {
            return Err(ActionResult::new_info_message(
                serde_json::json!({}),
                vec![player_id.to_string()],
                "ç©å®¶å°šæœªå‡ºç”Ÿï¼Œè¯·å…ˆé€‰æ‹©å‡ºç”Ÿåœ°ç‚¹".to_string(),
                false
            ));
        }
        
        Ok(())
    }
}
```

### æœç´¢é€»è¾‘ä¼˜åŒ–

é‡æ–°è®¾è®¡æœç´¢æœºåˆ¶ï¼Œç¡®ä¿ç»“æœçš„ä¸€è‡´æ€§ï¼š

```rust
impl GameState {
    pub fn handle_search_action(&mut self, player_id: &str) -> Result<ActionResult, String> {
        // 1. åŸºç¡€çŠ¶æ€æ£€æŸ¥
        if let Err(action_result) = self.check_player_basic_status(player_id, Some(self.rules.action_costs.search)) {
            return Ok(action_result);
        }
        
        // 2. å‡ºç”ŸçŠ¶æ€æ£€æŸ¥
        if let Err(action_result) = self.check_player_born_status(player_id) {
            return Ok(action_result);
        }
        
        // 3. æœç´¢å†·å´æ£€æŸ¥
        // ... å†·å´é€»è¾‘
        
        // 4. æ±‡æ€»å½“å‰åœ°ç‚¹æ‰€æœ‰ç›®æ ‡
        let search_targets = self.collect_search_targets(player_id);
        
        // 5. ç­‰æ¦‚ç‡éšæœºé€‰æ‹©
        if !search_targets.is_empty() {
            let selected_target = self.select_random_target(&search_targets);
            // å¤„ç†æœç´¢ç»“æœ
        } else {
            // è¿”å›ç©ºç»“æœ
        }
    }
    
    fn collect_search_targets(&self, player_id: &str) -> Vec<SearchTarget> {
        let mut targets = Vec::new();
        
        // è·å–ç©å®¶å½“å‰ä½ç½®
        let player_location = &self.players[player_id].location;
        
        if let Some(place) = self.places.get(player_location) {
            // æ·»åŠ å…¶ä»–ç©å®¶åˆ°æœç´¢ç›®æ ‡
            for other_player_id in &place.players {
                if other_player_id != player_id {
                    targets.push(SearchTarget::Player(other_player_id.clone()));
                }
            }
            
            // æ·»åŠ ç‰©å“åˆ°æœç´¢ç›®æ ‡
            for item in &place.items {
                targets.push(SearchTarget::Item(item.id.clone()));
            }
        }
        
        targets
    }
}
```

### å‡»æ€æ‰è½ç‰©å“è¡Œä¸ºç»†åŒ–

#### å‡»æ€è€…æ”¶ç¼´æœºåˆ¶
å½“æ­»äº¡åç‰©å“å»å‘é…ç½®ä¸º`killer_takes_loot`æ—¶ï¼Œå‡»æ€è€…è·å¾—è¢«å‡»æ€è€…ç‰©å“çš„è¯¦ç»†æµç¨‹ï¼š

```rust
impl GameState {
    /// å¤„ç†ç©å®¶æ­»äº¡åçš„ç‰©å“åˆ†é…
    pub fn handle_player_death_loot(&mut self, killer_id: Option<&str>, dead_player_id: &str) -> Vec<GameEffect> {
        let mut effects = Vec::new();
        
        // è·å–æ­»è€…çš„æ‰€æœ‰ç‰©å“
        let dead_player_items = {
            let dead_player = &self.players[dead_player_id];
            let mut all_items = dead_player.inventory.clone();
            
            // æ·»åŠ è£…å¤‡çš„ç‰©å“åˆ°æ‰è½åˆ—è¡¨
            for weapon_id in &dead_player.equipped_weapons {
                if let Some(weapon) = dead_player.equipped_items_detail.get(weapon_id) {
                    all_items.push(weapon.clone());
                }
            }
            for armor_id in &dead_player.equipped_armors {
                if let Some(armor) = dead_player.equipped_items_detail.get(armor_id) {
                    all_items.push(armor.clone());
                }
            }
            if let Some(hand_item_id) = &dead_player.hand_item {
                if let Some(hand_item) = dead_player.equipped_items_detail.get(hand_item_id) {
                    all_items.push(hand_item.clone());
                }
            }
            
            all_items
        };
        
        if let Some(killer_id) = killer_id {
            // å‡»æ€è€…æ”¶ç¼´ç‰©å“
            let killer_current_inventory_size = self.players[killer_id].inventory.len();
            let max_backpack_size = self.rules.player_config.max_backpack_items;
            let available_slots = max_backpack_size - killer_current_inventory_size;
            
            if available_slots > 0 {
                // éšæœºé€‰æ‹©å¯æ”¶ç¼´çš„ç‰©å“æ•°é‡
                let items_to_take = available_slots.min(dead_player_items.len());
                let mut rng = rand::rng();
                
                // éšæœºæ‰“ä¹±ç‰©å“é¡ºåº
                let mut shuffled_items = dead_player_items.clone();
                shuffled_items.shuffle(&mut rng);
                
                // å‡»æ€è€…è·å¾—å‰Nä¸ªç‰©å“
                for item in shuffled_items.iter().take(items_to_take) {
                    self.players.get_mut(killer_id).unwrap().inventory.push(item.clone());
                    effects.push(GameEffect::ItemTransferred {
                        from_player: dead_player_id.to_string(),
                        to_player: killer_id.to_string(),
                        item_id: item.id.clone(),
                    });
                }
                
                // å‰©ä½™ç‰©å“æ‰è½åŸåœ°
                let remaining_items: Vec<Item> = shuffled_items.into_iter().skip(items_to_take).collect();
                self.drop_items_to_ground(&self.players[dead_player_id].location, remaining_items);
            } else {
                // å‡»æ€è€…èƒŒåŒ…å·²æ»¡ï¼Œæ‰€æœ‰ç‰©å“æ‰è½åŸåœ°
                self.drop_items_to_ground(&self.players[dead_player_id].location, dead_player_items);
            }
        } else {
            // æ— å‡»æ€è€…ï¼Œæ‰€æœ‰ç‰©å“æ‰è½åŸåœ°
            self.drop_items_to_ground(&self.players[dead_player_id].location, dead_player_items);
        }
        
        effects
    }
    
    /// å°†ç‰©å“æ‰è½åˆ°æŒ‡å®šåœ°ç‚¹
    fn drop_items_to_ground(&mut self, location: &str, items: Vec<Item>) {
        if let Some(place) = self.places.get_mut(location) {
            place.items.extend(items);
        }
    }
}
```

#### å‡»æ€ä¼˜å…ˆçº§è®¾è®¡
- **ç›´æ¥ä¼¤å®³å‡»æ€**ï¼šæ­¦å™¨æ”»å‡»ç›´æ¥è‡´æ­»çš„æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…ä¸ºå‡»æ€è€…
- **æŒç»­ä¼¤å®³å‡»æ€**ï¼šæµè¡€æ•ˆæœè‡´æ­»æ—¶ï¼Œè®¾ç½®æµè¡€æ•ˆæœçš„ç©å®¶ä¸ºå‡»æ€è€…
- **ç¯å¢ƒä¼¤å®³å‡»æ€**ï¼šç¼©åœˆã€å¯¼æ¼”æ“ä½œç­‰è‡´æ­»æ—¶ï¼Œæ— å‡»æ€è€…

### èƒŒåŒ…å®¹é‡é™åˆ¶å¤„ç†

#### æ¡æ‹¾ç‰©å“å®¹é‡æ£€æŸ¥
```rust
impl GameState {
    /// å¤„ç†æ¡æ‹¾è¡ŒåŠ¨ï¼ˆå¢å¼ºç‰ˆæœ¬ï¼‰
    pub fn handle_pick_action(&mut self, player_id: &str) -> Result<ActionResult, String> {
        // åŸºç¡€çŠ¶æ€æ£€æŸ¥...
        
        // æ£€æŸ¥èƒŒåŒ…å®¹é‡
        let player = self.players.get(player_id).unwrap();
        if player.inventory.len() >= self.rules.player_config.max_backpack_items {
            // èƒŒåŒ…å·²æ»¡ï¼Œè¿”å›Infoæç¤º
            let data = serde_json::json!({
                "message": "èƒŒåŒ…å·²æ»¡ï¼Œæ— æ³•æ‹¾å–æ›´å¤šç‰©å“"
            });
            let action_result = ActionResult::new_info_message(
                data,
                vec![player_id.to_string()],
                format!("ç©å®¶ {} å°è¯•æ‹¾å–ç‰©å“ä½†èƒŒåŒ…å·²æ»¡", player.name),
                false // ä¸å‘å¯¼æ¼”å¹¿æ’­
            );
            return Ok(action_result);
        }
        
        // æ‰§è¡Œæ­£å¸¸çš„æ¡æ‹¾é€»è¾‘...
    }
}
```

#### èƒŒåŒ…çŠ¶æ€æç¤ºä¼˜åŒ–
å‰ç«¯ç•Œé¢åº”å½“å®æ—¶æ˜¾ç¤ºèƒŒåŒ…å®¹é‡çŠ¶æ€ï¼š
```vue
<template>
  <div class="inventory-status">
    <span class="capacity-indicator" :class="{ 'full': isInventoryFull }">
      èƒŒåŒ…: {{ inventoryCount }}/{{ maxBackpackItems }}
    </span>
    <div v-if="isInventoryFull" class="capacity-warning">
      âš ï¸ èƒŒåŒ…å·²æ»¡ï¼Œè¯·å…ˆä¸¢å¼ƒç‰©å“
    </div>
  </div>
</template>
```

### ç‰©å“æ•ˆæœåº”ç”¨ç³»ç»Ÿ

æ ¹æ®ç‰©å“é…ç½®å®ç°ç²¾ç¡®çš„æ•ˆæœåº”ç”¨ï¼š

```rust
impl GameState {
    fn apply_consumable_effect(&mut self, player_id: &str, consumable: &ConsumableConfig) -> GameEffect {
        let player = self.players.get_mut(player_id).unwrap();
        
        match consumable.effect_type.as_str() {
            "heal" => {
                // æ²»ç–—æ•ˆæœ
                if consumable.cure_bleed && player.has_bleed_effect {
                    // ä¼˜å…ˆè§£é™¤æŒç»­ä¼¤å®³
                    player.has_bleed_effect = false;
                    if consumable.name.contains("çº¢èŠ±ä¸¹") {
                        // çº¢èŠ±ä¸¹åŒæ—¶æ¢å¤ç”Ÿå‘½å€¼
                        player.life = (player.life + consumable.effect_value).min(self.rules.player_config.max_life);
                    }
                } else {
                    // ç›´æ¥æ¢å¤ç”Ÿå‘½å€¼
                    player.life = (player.life + consumable.effect_value).min(self.rules.player_config.max_life);
                }
            },
            "strength" => {
                // ä½“åŠ›æ¢å¤
                player.strength = (player.strength + consumable.effect_value).min(self.rules.player_config.max_strength);
            },
            _ => {}
        }
        
        GameEffect::ConsumableUsed {
            effect_type: consumable.effect_type.clone(),
            effect_value: consumable.effect_value,
        }
    }
}
```

## å‰ç«¯ç•Œé¢ä¼˜åŒ–

### ç©å®¶ç•Œé¢åŠŸèƒ½å¢å¼º

åŸºäºè§„åˆ™é…ç½®åŠ¨æ€è°ƒæ•´ç•Œé¢å…ƒç´ ï¼š

#### æ“ä½œæŒ‰é’®çŠ¶æ€æ§åˆ¶
- æ ¹æ®ä½“åŠ›å€¼å’Œè¡ŒåŠ¨æ¶ˆè€—æ˜¾ç¤ºæŒ‰é’®å¯ç”¨æ€§
- æ˜¾ç¤ºæœç´¢å†·å´å€’è®¡æ—¶
- æ ¹æ®è£…å¤‡é™åˆ¶æ§åˆ¶è£…å¤‡æŒ‰é’®

#### ç‰©å“ç®¡ç†ç•Œé¢
- æŒ‰ç…§è§„åˆ™é…ç½®æ˜¾ç¤ºèƒŒåŒ…å®¹é‡é™åˆ¶
- åŒºåˆ†æ­¦å™¨ã€é˜²å…·å’Œå…¶ä»–ç‰©å“çš„è£…å¤‡ä½ç½®
- æ˜¾ç¤ºç‰©å“çš„è¯¦ç»†å±æ€§å’Œæ•ˆæœ

#### çŠ¶æ€ä¿¡æ¯æ˜¾ç¤º
- å®æ—¶æ˜¾ç¤ºç©å®¶çš„ç”Ÿå‘½å€¼ã€ä½“åŠ›å€¼
- æ˜¾ç¤ºè£…å¤‡çš„æ­¦å™¨å’Œé˜²å…·ä¿¡æ¯
- æ˜¾ç¤ºå½“å‰æŒç»­æ•ˆæœçŠ¶æ€

### å¯¼æ¼”ç•Œé¢åŠŸèƒ½å¢å¼º

#### è§„åˆ™é…ç½®ç®¡ç†
- æä¾›å¯è§†åŒ–çš„è§„åˆ™ç¼–è¾‘ç•Œé¢
- å®æ—¶é¢„è§ˆè§„åˆ™ä¿®æ”¹çš„å½±å“
- æ”¯æŒè§„åˆ™é…ç½®çš„å¯¼å…¥å¯¼å‡º

#### ç©å®¶çŠ¶æ€ç›‘æ§
- å®æ—¶æ˜¾ç¤ºæ‰€æœ‰ç©å®¶çš„è¯¦ç»†çŠ¶æ€
- æä¾›å¿«é€Ÿçš„çŠ¶æ€è°ƒæ•´å·¥å…·
- æ˜¾ç¤ºç©å®¶çš„è£…å¤‡å’Œç‰©å“ä¿¡æ¯

#### æ¸¸æˆç¯å¢ƒæ§åˆ¶
- åœ°å›¾çŠ¶æ€ç®¡ç†ï¼ˆç¼©åœˆã€æ‘§æ¯ï¼‰
- å¤©æ°”ç³»ç»Ÿæ§åˆ¶ç•Œé¢
- ç‰©å“ç©ºæŠ•ç®¡ç†å·¥å…·

## æµ‹è¯•éªŒè¯æ–¹æ¡ˆ

### è§„åˆ™ä¸€è‡´æ€§éªŒè¯

#### é…ç½®è§£ææµ‹è¯•
éªŒè¯å‰ç«¯å’Œåç«¯å¯¹ç›¸åŒè§„åˆ™é…ç½®çš„è§£æç»“æœä¸€è‡´æ€§

#### æ“ä½œé™åˆ¶æµ‹è¯•
ç¡®ä¿æ‰€æœ‰æ“ä½œéƒ½æ­£ç¡®åº”ç”¨è§„åˆ™é™åˆ¶

#### æ•ˆæœè®¡ç®—æµ‹è¯•
éªŒè¯ä¼¤å®³è®¡ç®—ã€ç‰©å“æ•ˆæœç­‰æ ¸å¿ƒé€»è¾‘çš„å‡†ç¡®æ€§

### ç”¨æˆ·ä½“éªŒæµ‹è¯•

#### ç•Œé¢åé¦ˆæµ‹è¯•
ç¡®ä¿ç•Œé¢èƒ½æ­£ç¡®åæ˜ å½“å‰çš„è§„åˆ™çŠ¶æ€

#### æ“ä½œæµç¨‹æµ‹è¯•
éªŒè¯å®Œæ•´çš„æ¸¸æˆæ“ä½œæµç¨‹ç¬¦åˆè§„åˆ™è®¾è®¡

#### é”™è¯¯å¤„ç†æµ‹è¯•
ç¡®ä¿å„ç§å¼‚å¸¸æƒ…å†µéƒ½æœ‰é€‚å½“çš„é”™è¯¯æç¤º

## æœ¬æ¬¡è¿­ä»£èŒƒå›´é™å®š

### åŒ…å«çš„åŠŸèƒ½èŒƒå›´
æœ¬æ¬¡è¿­ä»£ä¸“æ³¨äºæ ¸å¿ƒæ¸¸æˆé€»è¾‘çš„è§„åˆ™ä¸€è‡´æ€§å®ç°ï¼ŒåŒ…æ‹¬ï¼š

#### é«˜ä¼˜å…ˆçº§å®ç°å†…å®¹
1. **åŸºç¡€è§„åˆ™æ”¯æŒ**
   - åç«¯è§„åˆ™ç»“æ„ä½“å’Œè§£æå™¨
   - ç©å®¶çŠ¶æ€æ£€æŸ¥å…¬ç”¨å‡½æ•°ï¼ˆå­˜æ´»ã€å‡ºç”Ÿã€ä½“åŠ›ï¼‰
   - è¡ŒåŠ¨ä½“åŠ›æ¶ˆè€—éªŒè¯
   - æœç´¢å†·å´æ—¶é—´æ£€æŸ¥

2. **æ ¸å¿ƒç©å®¶æ“ä½œ**
   - å‡ºç”Ÿåœ°ç‚¹é€‰æ‹©å’ŒéªŒè¯
   - ç§»åŠ¨è¡ŒåŠ¨ï¼ˆä½“åŠ›æ¶ˆè€—ã€åœ°ç‚¹éªŒè¯ï¼‰
   - æœç´¢è¡ŒåŠ¨ï¼ˆç›®æ ‡æ±‡æ€»ã€ç­‰æ¦‚ç‡éšæœºã€å¤©æ°”å½±å“ï¼‰
   - æ‹¾å–è¡ŒåŠ¨ï¼ˆèƒŒåŒ…å®¹é‡æ£€æŸ¥ï¼‰
   - åŸºç¡€æ”»å‡»è¡ŒåŠ¨ï¼ˆæ­¦å™¨ä¼¤å®³è®¡ç®—ï¼‰

3. **ç‰©å“ç³»ç»ŸåŸºç¡€**
   - è£…å¤‡æ•°é‡é™åˆ¶éªŒè¯
   - åŸºç¡€ç‰©å“ä½¿ç”¨æ•ˆæœï¼ˆæ²»ç–—ã€ä½“åŠ›æ¢å¤ï¼‰
   - å‡»æ€æ‰è½ç‰©å“åˆ†é…æœºåˆ¶
   - èƒŒåŒ…å®¹é‡ç®¡ç†

4. **çŠ¶æ€ç®¡ç†ä¼˜åŒ–**
   - ç©å®¶çŠ¶æ€ç»“æ„ä½“æ‰©å±•
   - æŒç»­æ•ˆæœæ”¯æŒï¼ˆæµè¡€çŠ¶æ€ï¼‰
   - å‰åç«¯çŠ¶æ€åŒæ­¥æœºåˆ¶

### æ’é™¤çš„å¤æ‚åŠŸèƒ½
ä¸ºæ§åˆ¶è¿­ä»£å¤æ‚åº¦ï¼Œä»¥ä¸‹åŠŸèƒ½å°†åœ¨åç»­è¿­ä»£ä¸­å®ç°ï¼š

#### å»¶åå®ç°çš„é«˜çº§åŠŸèƒ½
1. **å¤æ‚åˆæˆç³»ç»Ÿ**
   - ç‰©å“å‡çº§é…æ–¹å¤„ç†
   - å‡çº§å™¨ä½¿ç”¨é€»è¾‘
   - åˆæˆç•Œé¢å’Œäº¤äº’æµç¨‹
   - åˆæˆææ–™éªŒè¯å’Œæ¶ˆè€—

2. **é«˜çº§æˆ˜æ–—æœºåˆ¶**
   - æ©™è‰²æ­¦å™¨çš„èŒƒå›´ä¼¤å®³æ•ˆæœ
   - æŒç»­ä¼¤å®³çš„å¤æ‚è®¡ç®—å’Œä¼ æ’­
   - å¤šç›®æ ‡æ”»å‡»å¤„ç†
   - æŠ¤ç”²ç©¿é€å’Œç‰¹æ®Šæ•ˆæœ

3. **å¤æ‚é“å…·æ•ˆæœ**
   - ä¾¦æŸ¥ç±»é“å…·çš„å®šä½å’Œæ­ç¤ºæœºåˆ¶
   - é¢„è¨€ç±»é“å…·çš„ä¿¡æ¯æŸ¥çœ‹åŠŸèƒ½
   - é™·é˜±ç±»é“å…·çš„åŒºåŸŸæ•ˆæœå’Œè§¦å‘æ¡ä»¶
   - é“å…·çš„ç‰¹æ®Šä½¿ç”¨æ¨¡å¼ï¼ˆç›´æ¥ä½¿ç”¨vsè£…å¤‡ä½¿ç”¨ï¼‰

4. **é«˜çº§ç¤¾äº¤åŠŸèƒ½**
   - é˜Ÿå‹è¡Œä¸ºè§„åˆ™çš„å®Œæ•´å®ç°
   - é˜Ÿå‹é—´ç‰©å“ä¼ é€’æœºåˆ¶
   - é˜Ÿå‹çŠ¶æ€æŸ¥çœ‹æƒé™
   - é˜Ÿå‹ä¼¤å®³å…ç–«ç³»ç»Ÿ

5. **æ¸¸æˆæµç¨‹æ§åˆ¶**
   - ç™½å¤©æŠ•ç¥¨ç³»ç»Ÿ
   - å¤œæ™šæ—¶é—´æ®µè‡ªåŠ¨æ§åˆ¶
   - ç¼©åœˆè‡ªåŠ¨è§¦å‘æœºåˆ¶
   - æ¸¸æˆé˜¶æ®µè½¬æ¢é€»è¾‘

6. **æ•°æ®æŒä¹…åŒ–ä¼˜åŒ–**
   - æ¸¸æˆçŠ¶æ€è‡ªåŠ¨ä¿å­˜
   - å†å²æ•°æ®ç»Ÿè®¡åˆ†æ
   - æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–
   - å¹¶å‘è®¿é—®æ§åˆ¶

### æŠ€æœ¯å€ºåŠ¡ç®¡æ§

#### ä»£ç ç®€åŒ–ç­–ç•¥
- **å ä½ç¬¦å®ç°**ï¼šå¤æ‚åŠŸèƒ½ä½¿ç”¨ç®€åŒ–é€»è¾‘å ä½ï¼Œç¡®ä¿åŸºç¡€æµç¨‹å¯è¿è¡Œ
- **æ¥å£é¢„ç•™**ï¼šä¸ºæœªæ¥åŠŸèƒ½é¢„ç•™æ‰©å±•æ¥å£ï¼Œé¿å…é‡æ„
- **æ–‡æ¡£å…ˆè¡Œ**ï¼šå¤æ‚æœºåˆ¶åœ¨è§„åˆ™æ–‡æ¡£ä¸­è¯¦ç»†å®šä¹‰ï¼Œä»£ç åˆ†é˜¶æ®µå®ç°

#### æµ‹è¯•è¦†ç›–ç­–ç•¥
- **åŸºç¡€åŠŸèƒ½å®Œæ•´æµ‹è¯•**ï¼šç¡®ä¿æ ¸å¿ƒæ“ä½œçš„æ­£ç¡®æ€§
- **è¾¹ç•Œæ¡ä»¶éªŒè¯**ï¼šä½“åŠ›ä¸è¶³ã€èƒŒåŒ…å·²æ»¡ç­‰å¼‚å¸¸æƒ…å†µå¤„ç†
- **è§„åˆ™ä¸€è‡´æ€§æ£€æŸ¥**ï¼šå‰åç«¯è§„åˆ™è§£æç»“æœä¸€è‡´æ€§éªŒè¯

é€šè¿‡æ˜ç¡®çš„èŒƒå›´é™å®šï¼Œæœ¬æ¬¡è¿­ä»£å°†ä¸“æ³¨äºå»ºç«‹ç¨³å›ºçš„åŸºç¡€æ¸¸æˆæ¡†æ¶ï¼Œä¸ºåç»­å¤æ‚åŠŸèƒ½çš„å®ç°å¥ å®šåšå®åŸºç¡€ã€‚

## ç©å®¶çŠ¶æ€è®°å½•å¯¹è±¡ç»†åŒ–è®¾è®¡

### åç«¯ç©å®¶çŠ¶æ€ç»“æ„ä½“æ‰©å±•

åŸºäºæ¸¸æˆè§„åˆ™çš„å…·ä½“éœ€æ±‚ï¼Œåç«¯`Player`ç»“æ„ä½“éœ€è¦å¢åŠ ä»¥ä¸‹å…³é”®å±æ€§ï¼š

#### æŒç»­æ•ˆæœçŠ¶æ€
```rust
/// ç©å®¶ç±»
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct Player {
    // ... ç°æœ‰å­—æ®µ ...
    
    /// æŒç»­ä¼¤å®³æ•ˆæœï¼ˆæµè¡€çŠ¶æ€ï¼‰
    pub bleed_damage: i32,
    /// æŒç»­ä¼¤å®³å‰©ä½™å›åˆæ•°
    pub bleed_rounds_remaining: i32,
    /// è£…å¤‡çš„æ­¦å™¨IDåˆ—è¡¨ï¼ˆæ”¯æŒå¤šæ­¦å™¨è£…å¤‡ï¼‰
    pub equipped_weapons: Vec<String>,
    /// è£…å¤‡çš„é˜²å…·IDåˆ—è¡¨ï¼ˆæ”¯æŒå¤šé˜²å…·è£…å¤‡ï¼‰
    pub equipped_armors: Vec<String>,
    /// é˜Ÿä¼IDï¼ˆç”¨äºé˜Ÿå‹è¡Œä¸ºåˆ¤æ–­ï¼‰
    pub team_id: Option<u32>,
    /// ç©å®¶æœ€å¤§ç”Ÿå‘½å€¼ï¼ˆå¯èƒ½è¢«è§„åˆ™æˆ–é“å…·å½±å“ï¼‰
    pub max_life: i32,
    /// ç©å®¶æœ€å¤§ä½“åŠ›å€¼ï¼ˆå¯èƒ½è¢«è§„åˆ™æˆ–é“å…·å½±å“ï¼‰
    pub max_strength: i32,
    /// å‡ºç”ŸçŠ¶æ€æ ‡è®°
    pub is_born: bool,
    /// å½“å‰é™å…»æ¢å¤ç”Ÿå‘½å€¼
    pub rest_life_recovery: i32,
    /// é™å…»æ¨¡å¼ä¸‹çš„ç§»åŠ¨æ¬¡æ•°é™åˆ¶
    pub rest_moves_used: i32,
    /// å½“å‰è£…å¤‡çš„å…·ä½“ç‰©å“æ˜ å°„ï¼ˆç”¨äºå¿«é€Ÿè®¿é—®ï¼‰
    pub equipped_items_detail: HashMap<String, Item>,
}
```

#### è£…å¤‡ç®¡ç†ä¼˜åŒ–
```rust
impl Player {
    /// æ£€æŸ¥æ˜¯å¦å¯ä»¥è£…å¤‡æŒ‡å®šç±»å‹çš„ç‰©å“
    pub fn can_equip_item(&self, item: &Item, rules: &GameRuleEngine) -> bool {
        match item.item_type {
            ItemType::Weapon => {
                self.equipped_weapons.len() < rules.player_config.max_equipped_weapons
            },
            ItemType::Equipment => {
                // åŒºåˆ†æŠ¤ç”²å’Œå…¶ä»–è£…å¤‡
                if self.is_armor_item(item) {
                    self.equipped_armors.len() < rules.player_config.max_equipped_armors
                } else {
                    true // å…¶ä»–è£…å¤‡ç±»å‹æš‚æ— é™åˆ¶
                }
            },
            _ => false // æ¶ˆè€—å“ä¸èƒ½è£…å¤‡
        }
    }
    
    /// åº”ç”¨æŒç»­ä¼¤å®³æ•ˆæœ
    pub fn apply_bleed_damage(&mut self) {
        if self.bleed_rounds_remaining > 0 {
            self.life -= self.bleed_damage;
            self.bleed_rounds_remaining -= 1;
            
            if self.life <= 0 {
                self.life = 0;
                self.is_alive = false;
            }
        }
    }
    
    /// è®¾ç½®æŒç»­ä¼¤å®³æ•ˆæœ
    pub fn set_bleed_effect(&mut self, damage: i32, rounds: i32) {
        self.bleed_damage = damage;
        self.bleed_rounds_remaining = rounds;
    }
    
    /// æ¸…é™¤æŒç»­ä¼¤å®³æ•ˆæœ
    pub fn clear_bleed_effect(&mut self) {
        self.bleed_damage = 0;
        self.bleed_rounds_remaining = 0;
    }
}
```

### å‰ç«¯çŠ¶æ€ç±»å‹å®šä¹‰æ›´æ–°

#### gameStateTypes.tsæ‰©å±•
```typescript
// ç©å®¶æ¥å£æ‰©å±•
export interface Player {
  id: string;
  name: string;
  location: string;
  life: number;
  strength: number;
  max_life: number; // æ–°å¢ï¼šæœ€å¤§ç”Ÿå‘½å€¼
  max_strength: number; // æ–°å¢ï¼šæœ€å¤§ä½“åŠ›å€¼
  inventory: Item[];
  equipped_weapons: string[]; // ä¿®æ”¹ï¼šæ”¯æŒå¤šæ­¦å™¨
  equipped_armors: string[]; // ä¿®æ”¹ï¼šæ”¯æŒå¤šé˜²å…·
  equipped_items_detail: Record<string, Item>; // æ–°å¢ï¼šè£…å¤‡è¯¦æƒ…
  hand_item: string | null;
  last_search_result: SearchResult | null;
  is_alive: boolean;
  is_bound: boolean;
  is_born: boolean; // æ–°å¢ï¼šå‡ºç”ŸçŠ¶æ€
  rest_mode: boolean;
  rest_life_recovery: number; // æ–°å¢ï¼šé™å…»æ¢å¤å€¼
  rest_moves_used: number; // æ–°å¢ï¼šé™å…»ç§»åŠ¨æ¬¡æ•°
  last_search_time: string | null;
  votes: number;
  team_id: number | null; // æ–°å¢ï¼šé˜Ÿä¼ID
  
  // æŒç»­æ•ˆæœçŠ¶æ€
  bleed_damage: number; // æ–°å¢ï¼šæŒç»­ä¼¤å®³æ•°å€¼
  bleed_rounds_remaining: number; // æ–°å¢ï¼šæŒç»­ä¼¤å®³å‰©ä½™å›åˆ
}

// è£…å¤‡åˆ†ç±»æ¥å£
export interface EquipmentSlots {
  weapons: Item[];
  armors: Item[];
  other: Item[];
}

// ç©å®¶çŠ¶æ€è¯¦æƒ…æ¥å£ï¼ˆç”¨äºå¯¼æ¼”ç•Œé¢å±•ç¤ºï¼‰
export interface PlayerStatusDetail {
  basic: {
    id: string;
    name: string;
    location: string;
    team_id: number | null;
    is_born: boolean;
  };
  health: {
    life: number;
    max_life: number;
    strength: number;
    max_strength: number;
    is_alive: boolean;
  };
  status: {
    is_bound: boolean;
    rest_mode: boolean;
    rest_life_recovery: number;
    rest_moves_used: number;
  };
  effects: {
    bleed_damage: number;
    bleed_rounds_remaining: number;
  };
  equipment: {
    weapons: Item[];
    armors: Item[];
    hand_item: Item | null;
    inventory: Item[];
  };
  activity: {
    last_search_result: SearchResult | null;
    last_search_time: string | null;
    votes: number;
  };
}
```

### å¯¼æ¼”ç«¯å®Œæ•´çŠ¶æ€å±•ç¤ºè®¾è®¡

#### ç©å®¶çŠ¶æ€ç›‘æ§ç»„ä»¶ä¼˜åŒ–
```vue
<template>
  <div class="player-status-monitor">
    <!-- ç©å®¶åˆ—è¡¨æ¦‚è§ˆ -->
    <div class="players-overview">
      <div 
        v-for="player in players" 
        :key="player.id"
        class="player-card"
        :class="{
          'player-dead': !player.is_alive,
          'player-bound': player.is_bound,
          'player-bleeding': player.bleed_rounds_remaining > 0
        }"
        @click="selectPlayer(player.id)"
      >
        <!-- åŸºç¡€ä¿¡æ¯ -->
        <div class="player-basic">
          <h4>{{ player.name }}</h4>
          <span class="location">{{ player.location || 'æœªå‡ºç”Ÿ' }}</span>
          <span v-if="player.team_id" class="team">é˜Ÿä¼{{ player.team_id }}</span>
        </div>
        
        <!-- ç”Ÿå‘½ä½“åŠ› -->
        <div class="player-health">
          <div class="health-bar">
            <span>ç”Ÿå‘½: {{ player.life }}/{{ player.max_life }}</span>
            <div class="bar">
              <div 
                class="fill life-fill" 
                :style="{ width: (player.life / player.max_life * 100) + '%' }"
              ></div>
            </div>
          </div>
          <div class="strength-bar">
            <span>ä½“åŠ›: {{ player.strength }}/{{ player.max_strength }}</span>
            <div class="bar">
              <div 
                class="fill strength-fill" 
                :style="{ width: (player.strength / player.max_strength * 100) + '%' }"
              ></div>
            </div>
          </div>
        </div>
        
        <!-- çŠ¶æ€æ•ˆæœ -->
        <div class="player-effects">
          <span v-if="!player.is_alive" class="status-dead">å·²æ­»äº¡</span>
          <span v-if="player.is_bound" class="status-bound">è¢«æ†ç»‘</span>
          <span v-if="player.rest_mode" class="status-rest">é™å…»æ¨¡å¼</span>
          <span v-if="player.bleed_rounds_remaining > 0" class="status-bleed">
            æµè¡€ {{ player.bleed_damage }}Ã—{{ player.bleed_rounds_remaining }}
          </span>
        </div>
        
        <!-- è£…å¤‡æ¦‚è§ˆ -->
        <div class="equipment-summary">
          <span class="equipment-count">
            æ­¦å™¨: {{ player.equipped_weapons.length }}/{{ maxWeapons }}
          </span>
          <span class="equipment-count">
            é˜²å…·: {{ player.equipped_armors.length }}/{{ maxArmors }}
          </span>
          <span class="inventory-count">
            èƒŒåŒ…: {{ player.inventory.length }}/{{ maxBackpack }}
          </span>
        </div>
      </div>
    </div>
    
    <!-- é€‰ä¸­ç©å®¶è¯¦æƒ… -->
    <div v-if="selectedPlayer" class="player-detail">
      <PlayerDetailPanel :player="selectedPlayer" />
    </div>
  </div>
</template>
```

#### ç©å®¶è¯¦æƒ…é¢æ¿ç»„ä»¶
```vue
<template>
  <div class="player-detail-panel">
    <h3>{{ player.name }} è¯¦ç»†çŠ¶æ€</h3>
    
    <!-- åŸºç¡€çŠ¶æ€ -->
    <section class="detail-section">
      <h4>åŸºç¡€çŠ¶æ€</h4>
      <div class="status-grid">
        <div class="status-item">
          <label>ä½ç½®:</label>
          <span>{{ player.location || 'æœªå‡ºç”Ÿ' }}</span>
        </div>
        <div class="status-item">
          <label>é˜Ÿä¼:</label>
          <span>{{ player.team_id ? `é˜Ÿä¼${player.team_id}` : 'æ— ' }}</span>
        </div>
        <div class="status-item">
          <label>çŠ¶æ€:</label>
          <span :class="statusClass">{{ statusText }}</span>
        </div>
      </div>
    </section>
    
    <!-- ç”Ÿå‘½ä½“åŠ›è¯¦æƒ… -->
    <section class="detail-section">
      <h4>ç”Ÿå‘½ä½“åŠ›</h4>
      <div class="health-detail">
        <div class="health-item">
          <label>ç”Ÿå‘½å€¼:</label>
          <div class="value-with-bar">
            <span>{{ player.life }}/{{ player.max_life }}</span>
            <div class="progress-bar">
              <div 
                class="progress-fill life" 
                :style="{ width: lifePercentage + '%' }"
              ></div>
            </div>
          </div>
        </div>
        <div class="health-item">
          <label>ä½“åŠ›å€¼:</label>
          <div class="value-with-bar">
            <span>{{ player.strength }}/{{ player.max_strength }}</span>
            <div class="progress-bar">
              <div 
                class="progress-fill strength" 
                :style="{ width: strengthPercentage + '%' }"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- æŒç»­æ•ˆæœ -->
    <section v-if="player.bleed_rounds_remaining > 0" class="detail-section">
      <h4>æŒç»­æ•ˆæœ</h4>
      <div class="effect-item bleed-effect">
        <span class="effect-icon">ğŸ©¸</span>
        <span class="effect-text">
          æµè¡€æ•ˆæœ: æ¯å›åˆå¤±å»{{ player.bleed_damage }}ç”Ÿå‘½å€¼ï¼Œå‰©ä½™{{ player.bleed_rounds_remaining }}å›åˆ
        </span>
      </div>
    </section>
    
    <!-- è£…å¤‡è¯¦æƒ… -->
    <section class="detail-section">
      <h4>è£…å¤‡è¯¦æƒ…</h4>
      <div class="equipment-detail">
        <div class="equipment-category">
          <h5>æ­¦å™¨ ({{ player.equipped_weapons.length }}/{{ maxWeapons }})</h5>
          <div class="equipment-list">
            <div 
              v-for="weaponId in player.equipped_weapons" 
              :key="weaponId"
              class="equipment-item"
            >
              <ItemDisplay :item="player.equipped_items_detail[weaponId]" />
            </div>
          </div>
        </div>
        
        <div class="equipment-category">
          <h5>é˜²å…· ({{ player.equipped_armors.length }}/{{ maxArmors }})</h5>
          <div class="equipment-list">
            <div 
              v-for="armorId in player.equipped_armors" 
              :key="armorId"
              class="equipment-item"
            >
              <ItemDisplay :item="player.equipped_items_detail[armorId]" />
            </div>
          </div>
        </div>
        
        <div class="equipment-category">
          <h5>æ‰‹æŒç‰©å“</h5>
          <div class="hand-item">
            <ItemDisplay 
              v-if="player.hand_item" 
              :item="getHandItemDetail(player.hand_item)" 
            />
            <span v-else class="no-item">æ— </span>
          </div>
        </div>
      </div>
    </section>
    
    <!-- èƒŒåŒ…è¯¦æƒ… -->
    <section class="detail-section">
      <h4>èƒŒåŒ…ç‰©å“ ({{ player.inventory.length }}/{{ maxBackpack }})</h4>
      <div class="inventory-grid">
        <ItemDisplay 
          v-for="item in player.inventory" 
          :key="item.id"
          :item="item"
          class="inventory-item"
        />
      </div>
    </section>
    
    <!-- æœ€è¿‘æ´»åŠ¨ -->
    <section class="detail-section">
      <h4>æœ€è¿‘æ´»åŠ¨</h4>
      <div class="activity-info">
        <div class="activity-item">
          <label>ä¸Šæ¬¡æœç´¢:</label>
          <span>{{ formatSearchTime(player.last_search_time) }}</span>
        </div>
        <div class="activity-item">
          <label>æœç´¢ç»“æœ:</label>
          <span>{{ formatSearchResult(player.last_search_result) }}</span>
        </div>
        <div class="activity-item">
          <label>æŒæœ‰ç¥¨æ•°:</label>
          <span>{{ player.votes }}</span>
        </div>
      </div>
    </section>
  </div>
</template>
```

### ç©å®¶ç«¯çŠ¶æ€å±•ç¤ºä¼˜åŒ–

#### ç©å®¶çŠ¶æ€ç»„ä»¶æ‰©å±•
```vue
<template>
  <div class="actor-status-panel">
    <!-- ç”Ÿå‘½ä½“åŠ›çŠ¶æ€ -->
    <div class="health-status">
      <div class="health-item">
        <div class="health-label">ç”Ÿå‘½å€¼</div>
        <div class="health-bar">
          <div 
            class="health-fill" 
            :class="{ 'low-health': isLowHealth }"
            :style="{ width: lifePercentage + '%' }"
          ></div>
          <span class="health-text">{{ player.life }}/{{ player.max_life }}</span>
        </div>
      </div>
      
      <div class="health-item">
        <div class="health-label">ä½“åŠ›å€¼</div>
        <div class="health-bar">
          <div 
            class="strength-fill" 
            :class="{ 'low-strength': isLowStrength }"
            :style="{ width: strengthPercentage + '%' }"
          ></div>
          <span class="health-text">{{ player.strength }}/{{ player.max_strength }}</span>
        </div>
      </div>
    </div>
    
    <!-- çŠ¶æ€æ•ˆæœæç¤º -->
    <div v-if="hasStatusEffects" class="status-effects">
      <div v-if="!player.is_alive" class="effect-alert death">
        âš°ï¸ æ‚¨å·²æ­»äº¡
      </div>
      <div v-if="player.is_bound" class="effect-alert bound">
        ğŸ”’ æ‚¨è¢«æ†ç»‘ï¼Œæ— æ³•è¡ŒåŠ¨
      </div>
      <div v-if="player.bleed_rounds_remaining > 0" class="effect-alert bleeding">
        ğŸ©¸ æµè¡€çŠ¶æ€ï¼šæ¯å›åˆå¤±å»{{ player.bleed_damage }}ç”Ÿå‘½å€¼ (å‰©ä½™{{ player.bleed_rounds_remaining }}å›åˆ)
      </div>
      <div v-if="player.rest_mode" class="effect-info rest">
        ğŸ˜´ é™å…»æ¨¡å¼ï¼šå°†æ¢å¤{{ player.rest_life_recovery }}ç”Ÿå‘½å€¼
      </div>
    </div>
    
    <!-- è£…å¤‡çŠ¶æ€ -->
    <div class="equipment-status">
      <div class="equipment-summary">
        <span class="equipment-item">
          æ­¦å™¨: {{ player.equipped_weapons.length }}/{{ maxWeapons }}
        </span>
        <span class="equipment-item">
          é˜²å…·: {{ player.equipped_armors.length }}/{{ maxArmors }}
        </span>
        <span class="equipment-item">
          èƒŒåŒ…: {{ player.inventory.length }}/{{ maxBackpack }}
        </span>
      </div>
    </div>
    
    <!-- ä½ç½®å’ŒåŸºç¡€ä¿¡æ¯ -->
    <div class="location-info">
      <div class="info-item">
        <label>å½“å‰ä½ç½®:</label>
        <span>{{ player.location || 'æœªå‡ºç”Ÿ' }}</span>
      </div>
      <div v-if="player.team_id" class="info-item">
        <label>é˜Ÿä¼:</label>
        <span>é˜Ÿä¼{{ player.team_id }}</span>
      </div>
    </div>
  </div>
</template>
```

### çŠ¶æ€åŒæ­¥æœºåˆ¶ä¼˜åŒ–

#### WebSocketæ¶ˆæ¯æ ¼å¼æ‰©å±•
ç¡®ä¿å‰åç«¯çŠ¶æ€åŒæ­¥æ—¶åŒ…å«æ‰€æœ‰æ–°å¢çš„çŠ¶æ€ä¿¡æ¯ï¼š

```rust
// åç«¯broadcaster.rsä¸­çš„æ¶ˆæ¯ç”Ÿæˆ
pub fn generate_player_message(game_state: &GameState, player: &Player, action_result: Option<&ActionResult>) -> JsonValue {
    json!({
        "global_state": game_state.generate_global_state_info(),
        "game_data": {
            "player": {
                // åŒ…å«æ‰€æœ‰æ‰©å±•çš„ç©å®¶çŠ¶æ€å­—æ®µ
                "id": player.id,
                "name": player.name,
                "location": player.location,
                "life": player.life,
                "strength": player.strength,
                "max_life": player.max_life,
                "max_strength": player.max_strength,
                "inventory": player.inventory,
                "equipped_weapons": player.equipped_weapons,
                "equipped_armors": player.equipped_armors,
                "equipped_items_detail": player.equipped_items_detail,
                "hand_item": player.hand_item,
                "last_search_result": player.last_search_result,
                "is_alive": player.is_alive,
                "is_bound": player.is_bound,
                "is_born": player.is_born,
                "rest_mode": player.rest_mode,
                "rest_life_recovery": player.rest_life_recovery,
                "rest_moves_used": player.rest_moves_used,
                "last_search_time": player.last_search_time,
                "votes": player.votes,
                "team_id": player.team_id,
                "bleed_damage": player.bleed_damage,
                "bleed_rounds_remaining": player.bleed_rounds_remaining
            },
            "places": generate_actor_places_info(game_state)
        },
        "action_result": action_result.map(|res| res.to_client_response())
    })
}
```

### æŠ€æœ¯å®ç°æ³¨æ„äº‹é¡¹

#### æ€§èƒ½ä¼˜åŒ–
- è£…å¤‡è¯¦æƒ…æ˜ å°„åº”å½“åœ¨è£…å¤‡å˜æ›´æ—¶å®æ—¶æ›´æ–°ï¼Œé¿å…é‡å¤æŸ¥è¯¢
- æŒç»­æ•ˆæœè®¡ç®—åº”å½“æ‰¹é‡å¤„ç†ï¼Œåœ¨æ¯å›åˆå¼€å§‹æ—¶ç»Ÿä¸€åº”ç”¨
- å‰ç«¯çŠ¶æ€å±•ç¤ºåº”å½“ä½¿ç”¨è®¡ç®—å±æ€§ï¼Œé¿å…é‡å¤è®¡ç®—

#### æ•°æ®ä¸€è‡´æ€§
- åç«¯Playerç»“æ„ä½“çš„æ‰€æœ‰å­—æ®µå˜æ›´éƒ½åº”å½“åŒæ­¥åˆ°å‰ç«¯
- è£…å¤‡é™åˆ¶æ£€æŸ¥åº”å½“åœ¨å‰åç«¯åŒæ—¶è¿›è¡ŒéªŒè¯
- æŒç»­æ•ˆæœçš„å›åˆè®¡ç®—åº”å½“ä¸æ¸¸æˆæ—¶é—´ç³»ç»Ÿä¿æŒåŒæ­¥

#### æ‰©å±•æ€§è€ƒè™‘
- æ–°å¢çŠ¶æ€æ•ˆæœåº”å½“éµå¾ªç»Ÿä¸€çš„å‘½åå’Œæ•°æ®ç»“æ„è§„èŒƒ
- è£…å¤‡ç³»ç»Ÿåº”å½“æ”¯æŒæœªæ¥å¯èƒ½çš„ç‰©å“åˆ†ç±»æ‰©å±•
- çŠ¶æ€å±•ç¤ºç»„ä»¶åº”å½“æ”¯æŒé…ç½®åŒ–çš„æ˜¾ç¤ºå†…å®¹

é€šè¿‡ä»¥ä¸Šè¯¦ç»†çš„çŠ¶æ€è®°å½•å¯¹è±¡ç»†åŒ–è®¾è®¡ï¼Œç³»ç»Ÿå°†èƒ½å¤Ÿå®Œæ•´æ”¯æŒå¤æ‚çš„æ¸¸æˆçŠ¶æ€ç®¡ç†ï¼Œä¸ºå¯¼æ¼”æä¾›å…¨é¢çš„ç©å®¶ç›‘æ§èƒ½åŠ›ï¼Œä¸ºç©å®¶æä¾›å‡†ç¡®çš„è‡ªèº«çŠ¶æ€åé¦ˆã€‚